#The groupings will be stored in this list
out=[]

def enoughdata(df):
    #List of names of all columns in the dataframe df 
	trainCols=list(df.columns)
    
    #Since we want to use this list as our training columns, we remove the rowid column( as it doesnt effect if a planet is habitable or not) and 
    #the habitable column(as that will be used as our prediction variable)
	trainCols.remove('rowid')
	trainCols.remove('habitable')

    #We sort the resulting list and join all the strings in it with commas, so that we get a single string.
    #So if i get the columns 'a' and 'b'. The resulting string is 'a,b' 
	trainCols.sort()
	trainCols=",".join(trainCols)

    #The purpose of sorting the list before hand is so that we can easily check if that combination of 
    #columns has been encountered before
    #So here we check whether the current string of features has already been selected. If it has we return 0
	if(trainCols in out):
		return 0

    #Here we check how many habitable planets are in the dataframe passed as arguement.
    #If theres less than 10 then we return 0. 
	num=0
	for n in habitable:
		if n in df.rowid:
			num+=1
	if num<10:
		return 0
    
    #Lastly we check whether there enough data to train on. So if there less than 200 rows of
    #data we return 0. Else we return the string of training columns
	if len(data)<200:
		return 0
	return trainCols



MinLen=500 
numCols=len(exos.columns)
numTests=0
while numTests<10000:
	features=list(exos.columns)
	features.remove('rowid')
	features.remove('habitable')
    #These two features are required later on so we add them to selected features right at the beginning
	SelectedFeats=['rowid','habitable']
    #Randomly select the number of features that we will be using
	numFeats=r.randint(3,numCols-3)
	for i in range(numFeats):
        #Randomly select a feature from the features list and add it to the Selected features list
		featureNum=r.randint(0,len(features)-1)
		SelectedFeats.append(features[featureNum])
		del features[featureNum]

    #Make a copy of the columns in the exos dataset having all columns in the selectedFeatures list 
	data=exos[SelectedFeats].copy()
    
    #remove rows that have missing data as these cannot be used to train machine learning models
	data=data.dropna()
	trainCols=enoughdata(data)
    #if there isnt enough data trainCols=0 so the following if statement doesnt get executed
	if trainCols:
		out.append(trainCols)
        numTests+=1

    #Create numTests is divisible by 5000.
    #This ensures that if the program exits at some point we know approximately where it stopped 
    #and have some data to work with
		if(numTests%5000==0):
			pd.DataFrame(out).to_csv('randomFeatureGroupings.csv')